{% load static %}
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://unpkg.com/feather-icons"></script>
    <link rel="stylesheet" href="{% static 'blog/content.css' %}?v=2.2">
    <title>Threeofkind.supply - Artistry in Every Detail</title>
    
    <style>
        html { scroll-behavior: smooth; }
        .modal-stock, #modalStock, .stock-status, .stock-info, .stock-count {
            display: none !important; visibility: hidden !important; height: 0 !important;
            overflow: hidden !important; opacity: 0 !important;
        }
        /* Style tambahan untuk handling gambar kosong */
        .product-image img {
            width: 100%; height: 100%; object-fit: cover;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <a href="/">
                    <img src="{% static 'blog/pict/logo.png'%}?v=2.0" class="logo-image">
                </a>
            </div>
            
            <nav class="nav">
                <a href="javascript:void(0)" onclick="window.location.href='/'">Home</a>
                <a href="javascript:void(0)" onclick="document.getElementById('catalog').scrollIntoView({behavior:'smooth',block:'start'})">Product</a>
                <a href="javascript:void(0)" onclick="document.getElementById('about-section').scrollIntoView({behavior:'smooth',block:'start'})">About Us</a>
                <a href="/contact/">Contact</a>
            </nav>
            
            <div class="header-right">
                <a href="/cart/" class="cart-btn">
                    <i data-feather="shopping-cart"></i>
                    <span class="cart-badge" id="cart-badge-header">0</span> 
                </a>
                <a href="/wishlist/" class="cart-btn" id="wishlist-btn">
                    <i data-feather="heart"></i>
                    <span class="cart-badge" id="wishlist-badge-header" style="display: none;">0</span>
                </a>
                <a href="/payment/" class="cart-btn" id="payment-btn">
                    <i data-feather="credit-card"></i>
                </a>
                
                {% if request.user.is_authenticated %}
                    <a href="/profile/" class="cart-btn" id="user-btn" title="Profile Dashboard">
                        <i data-feather="user"></i>
                        <span style="margin-left: 8px; font-weight: 500;">Hi, {{ request.user.username }}</span>
                    </a>
                {% else %}
                    <a href="/login/" class="cart-btn" id="user-btn" title="Login/Register">
                        <i data-feather="user"></i>
                    </a>
                {% endif %}
            </div>
        </div>
    </header>

    <section class="hero-section" id="hero">
        <div class="hero-content">
            <div class="hero-text">
                <h1>Welcome to <span class="brand-highlight">Threeofkind.supply</span></h1>
                <p class="hero-subtitle">Artistry in Every Detail.</p>
                <p class="hero-description">
                    Jelajahi koleksi gelang dan kalung premium kami, 
                    yang dirancang untuk bikin gaya harianmu makin on point.
                    Temukan perpaduan tren kekinian dan gaya klasik yang elegan di sini.
                </p>
            </div>
            <div class="hero-image"></div>
        </div>
    </section>

    <section class="about-section" id="about-section">
        <div class="about-content">
            <h2>About Threeofkind.supply</h2>
            <p>
                Kenapa kami ada? Sederhana. Kamu capek cari aksesoris bagus yang nggak pasaran dan kualitasnya oke.
                Jadi, di tahun 2025 ini, kami putuskan buat bikin Threeofkind.supply.
                Kami menghadirkan gelang dan kalung untuk memastikan kamu cuma dapat yang terbaik desain keren, bahan awet, 
                dan pastinya, bikin kamu makin percaya diri.
            </p>
        </div>
    </section>

    <div class="main-content" id="catalog">
        <main class="content">
            <div class="content-header">
                <h2>Featured Products ({{ product_count }})</h2>
                
                <div class="view-controls">
                    <div class="view-toggle">
                        <button class="view-btn active"><i data-feather="grid"></i></button>
                        <button class="view-btn"><i data-feather="list"></i></button>
                    </div>
                    
                    <select class="sort-select" onchange="location = this.value;">
                        <option value="?sort=relevance" {% if current_sort == 'relevance' %}selected{% endif %}>Sort by: Relevance</option>
                        <option value="?sort=price_low" {% if current_sort == 'price_low' %}selected{% endif %}>Price: Low to High</option>
                        <option value="?sort=price_high" {% if current_sort == 'price_high' %}selected{% endif %}>Price: High to Low</option>
                        <option value="?sort=newest" {% if current_sort == 'newest' %}selected{% endif %}>Newest</option>
                    </select>
                </div>
            </div>

            <div class="product-card" 
                data-product-id="{{ product.id }}" 
                data-name="{{ product.name }}"
                data-price="{{ product.price|floatformat:0 }}"
                data-image="{{ product.image.url }}"
                data-description="{{ product.description|default:'Deskripsi produk belum tersedia.' }}"
                onclick="openProductModal(this)" 
                style="cursor: pointer;">
    
                <div class="product-image">
                    {% if product.image %}
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" />
                    {% else %}
                    <img src="https://via.placeholder.com/300x300?text=No+Image" alt="No Image" />
                    {% endif %}

                    {% if product.stock < 5 and product.stock > 0 %}
                    <span class="product-badge badge-discount">Low Stock</span>
                    {% endif %}

                    <button class="favorite-btn" onclick="event.stopPropagation(); toggleFavorite(this);">
                        <i data-feather="heart"></i>
                    </button>
                </div>
    
                <div class="product-info">
                    <h3 class="product-name">{{ product.name }}</h3>
                    <div class="product-price">
                        <span class="current-price">IDR {{ product.price|floatformat:0 }}</span>
                    </div>
                </div>
                </div> {% empty %}
                <div style="grid-column: 1/-1; text-align: center; padding: 50px;">
                    <h3>Belum ada produk yang tersedia saat ini.</h3>
                    <p>Silakan cek kembali nanti atau hubungi admin.</p>
                </div>
                {% endfor %}
            </div>

            <div style="text-align: center; margin-top: 3rem;">
                <a href="javascript:void(0)" class="btn btn-primary" style="display: inline-flex; padding: 14px 32px; text-decoration: none; font-size: 1.05rem;">
                    <i data-feather="shopping-bag"></i>
                    Lihat Semua Produk
                </a>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="productModal" onclick="closeModal()">
        <div class="modal-content" onclick="event.stopPropagation()">
            <button class="modal-close" onclick="closeModal()"><i data-feather="x"></i></button>
            
            <div class="modal-body">
                <div class="modal-image">
                    <img id="modalImage" src="" alt="" />
                </div>
                
                <div class="modal-info">
                    <h2 id="modalTitle"></h2>
                    
                    <div class="modal-price">
                        <span class="current-price" id="modalCurrentPrice"></span>
                        <span class="original-price" id="modalOriginalPrice"></span>
                    </div>
                    
                    <div class="modal-tabs">
                        <button class="modal-tab-btn active" data-tab="description">Deskripsi</button>
                        <button class="modal-tab-btn" data-tab="features">Fitur</button>
                    </div>
                    
                    <div class="modal-tab-content active" id="tab-description">
                        <p id="modalDescription">Deskripsi produk detail akan muncul di sini.</p>
                    </div>
                    
                    <div class="modal-tab-content" id="tab-features">
                        <ul id="modalFeatures">
                            <li>Bahan Titanium Anti Karat</li>
                            <li>Aman untuk kulit sensitif</li>
                            <li>Design Eksklusif</li>
                        </ul>
                    </div>

                    <div class="modal-actions">
                        <div class="quantity-selector">
                            <button onclick="decreaseQuantity()">-</button>
                            <input type="number" id="quantityInput" value="1" min="1" max="99" />
                            <button onclick="increaseQuantity()">+</button>
                        </div>
                        
                        <button class="add-to-cart-btn" onclick="addToCartFromModal()">
                            <i data-feather="shopping-cart"></i> Add to Cart
                        </button>
                        
                        <button class="buy-now-btn" onclick="buyNowFromModal()">
                            <i data-feather="credit-card"></i> Buy Now
                        </button>
                        
                        <button class="favorite-modal-btn" onclick="toggleFavoriteModal()">
                            <i data-feather="heart"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    {% include 'blog/footer.html' %}

    <script src="https://unpkg.com/feather-icons"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            if (typeof feather !== 'undefined') { feather.replace(); }
        });
    </script>
    <script src="{% static 'blog/lund.js' %}?v=999.0"></script>
</body>
</html>